backend api_nrel_farm
  # Strip /api/nrel from the beginning of the request URL before the receiving
  # backend application sees the request.
  #
  # Turns a request from "GET /api/nrel/something" to "GET /api/something"
  reqirep ^([^\ ]*)\ /api/nrel(/.*) \1\ /api\2

  # Strip the `api_key` GET parameter out of the URL for all requests.
  reqirep ^([^\ ]*)\ (.*)(\?)(.*)api_key=[^&\ ]*&?(.*) \1\ \2\3\4\5

  # Strip trailing "&" or "?" from the URL. Might have been left by the
  # stripping of the `api_key` parameter.
  reqirep ^([^\ ]*)\ (.*)[&\?]\ (.*) \1\ \2\ \3

  # Add a unique API key for accessing developer.nrel.gov content.
  #
  # Append the new api_key as an additional query parameter.
  reqirep ^([^\ ]*)\ (.*\?.*)\ (.*) \1\ \2&api_key=bcc50c5b78ad7fe4109dffad2bcc1b8d28f724c6\ \3
  # Append the new api_key as the only query parameter.
  reqirep ^([^\ ]*)\ ([^\?]*)\ (.*) \1\ \2?api_key=bcc50c5b78ad7fe4109dffad2bcc1b8d28f724c6\ \3

  balance roundrobin
  server api_nrel1 developer.nrel.gov:80
