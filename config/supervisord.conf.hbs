[unix_http_server]
file={{run_dir}}/supervisor.sock

[supervisord]
pidfile={{run_dir}}/supervisord.pid
logfile={{log_dir}}/supervisor/supervisord.log
logfile_maxbytes=0
childlogdir={{log_dir}}/supervisor

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix://{{run_dir}}/supervisor.sock

[program:nginx_router]
command=nginx -c {{config_dir}}/nginx/router.conf

[program:varnish]
command=varnishd -F -a :{{varnish_port}} -f {{config_dir}}/varnish.vcl -t 0 -n api-umbrella

[program:varnishlog]
command=varnishlog -a -w {{log_dir}}/varnishncsa.log -n api-umbrella

[program:varnishncsa]
command=varnishncsa -a -f -w {{log_dir}}/varnishncsa.log -n api-umbrella

[program:gatekeeper]
numprocs=4
command=api_umbrella_gatekeeper {{api_umbrella_config_args}} -p 50%(process_num)03d

; Name each process by the port number
process_name=50%(process_num)03d

[program:logging]
command=api_umbrella_logging {{api_umbrella_config_args}}

[program:distributed_rate_limits_sync]
command=api_umbrella_distributed_rate_limits_sync {{api_umbrella_config_args}}

[program:nginx_web]
command=nginx -c {{config_dir}}/nginx_web.conf

[program:mongodb]
command=mongod --config {{config_dir}}/mongod.conf

[program:elasticsearch]
environment=ES_INCLUDE=/usr/local/etc/elasticsearch/elasticsearch-env.sh
command=elasticsearch
