#!/bin/sh

# Redirect stderr to stdout
exec 2>&1

if test ${1} = "start"; then
  echo "starting ${2}..."
  exec \
    runenv rc.env \
    bundle exec \
      puma \
      -q \
      --dir {{web.dir}} \
      --prune-bundler \
      -e {{app_env}} \
      -w {{web.puma.workers}} \
      -t {{web.puma.min_threads}}:{{web.puma.max_threads}} \
      -b unix://{{run_dir}}/web-puma.sock
fi

exit 0
